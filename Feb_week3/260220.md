# 🔤 문자열 배열 대입과 메모리 복사

## 1. 배열 대입 연산의 제한 (중요)

* **배열 이름은 주소입니다.**
* **에러 발생 원인:** * 배열 변수인 `ch`도 메모리 주소이고, 우변의 `"ABCDEF"`도 메모리 어딘가에 저장된 문자열의 시작 주소입니다.
    * 주소 값 자체를 대입 연산자(`=`)로 변경할 수 없으므로, 선언 이후에 문자열을 직접 넣으면 에러가 발생합니다.

### 1) 선언과 동시에 초기화 (가능)
* 컴파일러가 메모리 어딘가에 저장된 `"ABCDEF"`의 문자들을 `ch` 배열 방에 하나씩 복사해서 저장해 줍니다.
* 배열에서 변수를 초기화할 때는 배열 공간의 개수인 숫자는 생략이 가능합니다.
```c
char ch[] = "ABCDEF"; // 가능
```

### 2) 선언 이후 대입 (불가능)
* char형 문자열 배열을 선언하고 값을 초기화하지 않은 경우에는 그 다음에 대입 연산자로 문자열을 저장할 수 없습니다.
* 배열은 일반 변수처럼 문자열을 통째로 대입할 수 없기 때문입니다.
```c
char ch[7];
ch = "ABCDEF"; // [에러 발생] assignment to expression with array type
```
* **해결 방법:** 이때는 함수(`strcpy`, `strncpy`, `scanf` 등)를 이용해야 합니다.

---

## 2. 실습: 문자열 복사 함수 (`array6.c`)

### `strcpy()` 함수 주의사항
* **보안 취약점:** 입력값에 경계를 검사하지 않고 복사하므로 **BOF(Buffer OverFlow)**가 발생할 수 있어 실무에서는 사용하지 않습니다.
* 연습 단계에서는 원리 파악을 위해 사용하며, `string.h` 헤더가 필요합니다.

```c
// array6.c
#include <stdio.h>
#include <string.h>  // strcpy

int main()
{
    char ch[] = "ABCDEF";    // 가능
    char ch2[7] = "111111";

    // ch = "ABCDEF";        // 불가능 (에러 발생)

    // strcpy(목적지, 출발지)
    // "111111"이 저장되어 있던 ch2에 "AAAAAA"를 복사함
    strcpy(ch2, "AAAAAA"); 

    printf("ch = %s, ch2 = %s\n", ch, ch2); 
    return 0;
}
```

---

## 3. GDB 설정 및 메모리 분석

### 1) GDB 설정 파일 (`~/.gdbinit`)
* **`~` (Tilde):** 홈 디렉터리(`/home/linuxadmin`)를 의미합니다.
* **`.gdbinit`:** GDB의 설정 파일입니다.

```bash
# 설정 파일 수정 (nano 편집기 활용)
$ nano ~/.gdbinit

# 아래 내용 입력 후 저장 (Ctrl+x > y > Enter)
set debuginfod enabled off

# 설정 확인
$ cat ~/.gdbinit
set debuginfod enabled off
```

### 2) GDB 메모리 정밀 분석
`ch`와 `ch2`는 메모리상에 같이 붙어 있으므로, 메모리 크기를 크게 지정하면 두 변수의 값을 동시에 확인할 수 있습니다.

```gdb
(gdb) b main
(gdb) r
(gdb) n  # 코드 진행...

(gdb) p &ch[0]
$4 = 0x7fffffffe1aa "ABCDEF"

(gdb) p &ch2[0]
$5 = 0x7fffffffe1b1 "111111"

# 배열의 이름은 주소이므로 x 명령어로 직접 확인 가능
(gdb) x/2xw ch
0x7fffffffe1aa: 0x44434241      0x31004645

# strcpy 실행 후 값 변경 확인 (111111 -> AAAAAA)
(gdb) x/4xw ch
0x7fffffffe1aa: 0x44434241      0x41004645      0x41414141      0xf4000041
```

---

## 4. [LAB] 사용자 정보 입력 프로그램 (`array7.c`)

배열과 `scanf`를 이용하여 정보를 입력받고 출력하는 예제입니다.

```c
// array7.c
// 배열에 값 저장하기
#include <stdio.h>

int main()
{
    char name[25];  // 이름
    char phone[25]; // 전화번호
    int age;        // 나이

    printf("이름: ");
    // 문자열은 배열 이름(시작 주소)을 그대로 전달함
    scanf("%s", name);   
    
    printf("연락처: ");
    scanf("%s", phone);
    
    printf("나이: ");
    // 일반 변수는 주소 연산자(&)를 붙여서 주소를 전달함
    scanf("%d", &age);

    printf("입력한 정보는 아래와 같습니다.\n");
    printf("이름: %s, 연락처: %s, 나이: %d\n", name, phone, age);

    return 0;
}
```

### 실행 결과
```bash
$ gcc -g -Wall -o array7 array7.c
$ ./array7
이름: 홍길동
연락처: 010-1234-5678
나이: 12
입력한 정보는 아래와 같습니다.
이름: 홍길동, 연락처: 010-1234-5678, 나이: 12
```
